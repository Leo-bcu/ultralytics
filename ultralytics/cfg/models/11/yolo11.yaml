# Ultralytics ğŸš€ AGPL-3.0 License - https://ultralytics.com/license

# Ultralytics YOLO11 object detection model with P3/8 - P5/32 outputs
# Model docs: https://docs.ultralytics.com/models/yolo11
# Task docs: https://docs.ultralytics.com/tasks/detect

# Parameters
nc: 80 # number of classes
scales: # model compound scaling constants, i.e. 'model=yolo11n.yaml' will call yolo11.yaml with scale 'n'
  # [depth, width, max_channels]
  n: [0.50, 0.25, 1024] # summary: 181 layers, 2624080 parameters, 2624064 gradients, 6.6 GFLOPs
  s: [0.50, 0.50, 1024] # summary: 181 layers, 9458752 parameters, 9458736 gradients, 21.7 GFLOPs
  m: [0.50, 1.00, 512] # summary: 231 layers, 20114688 parameters, 20114672 gradients, 68.5 GFLOPs
  l: [1.00, 1.00, 512] # summary: 357 layers, 25372160 parameters, 25372144 gradients, 87.6 GFLOPs
  x: [1.00, 1.50, 512] # summary: 357 layers, 56966176 parameters, 56966160 gradients, 196.0 GFLOPs

# YOLO11n backbone
backbone:
  # [from, repeats, module, args]                  640x640x3  è¾“å…¥å›¾åƒ
  - [-1, 1, Conv, [64, 3, 2]]         # 0-P1/2     320x320x64 ä¸‹é‡‡æ ·+æ‰©ç»´
  - [-1, 1, Conv, [128, 3, 2]]        # 1-P2/4     160x160x128 ä¸‹é‡‡æ ·+æ‰©ç»´
  - [-1, 2, C3k2, [256, False, 0.25]] # CSPNet     160x160x256 ç‰¹å¾æå–+P2ç²¾ä¿® è¯¥æ­¥éª¤å±äºæ ‡å‡†çš„ Bottleneckï¼ˆç“¶é¢ˆå±‚ï¼‰
  - [-1, 1, Conv, [256, 3, 2]]        # 3-P3/8     80x80x256   ä¸‹é‡‡æ ·+æ‰©ç»´
  - [-1, 2, C3k2, [512, False, 0.25]] # CSPNet     80x80x512   ç‰¹å¾æå–+P3ç²¾ä¿® è¯¥æ­¥éª¤å±äºæ ‡å‡†çš„ Bottleneckï¼ˆç“¶é¢ˆå±‚ï¼‰
  - [-1, 1, Conv, [512, 3, 2]]        # 5-P4/16    40x40x512 ä¸‹é‡‡æ ·+æ‰©ç»´
  - [-1, 2, C3k2, [512, True]]        # CSPNet     40x40x512 ç‰¹å¾æå–+P4ç²¾ä¿® è¯¥æ­¥éª¤å±äºè·¨é˜¶æ®µéƒ¨åˆ†è¿æ¥çš„CSPNetæ¨¡å—ï¼Œæ•è·å¤æ‚çš„è¯­ä¹‰ä¿¡æ¯ã€‚
  - [-1, 1, Conv, [1024, 3, 2]]       # 7-P5/32    20x20x1024 ä¸‹é‡‡æ ·+æ‰©ç»´
  - [-1, 2, C3k2, [1024, True]] # CSPNetæ¨¡å— 20x20x1024 ç‰¹å¾æå–+P5ç²¾ä¿®
  - [-1, 1, SPPF, [1024, 5]] # 9 # ç©ºé—´é‡‘å­—å¡”æ± åŒ–å±‚ 20x20x1024 å¢å¼ºæ„Ÿå—é‡+å¤šå°ºåº¦ç‰¹å¾èåˆ
  - [-1, 2, C2PSA, [1024]] # 10 # C2fæ¨¡å— 20x20x1024 ç‰¹å¾èåˆ+é€šé“æ³¨æ„åŠ›æœºåˆ¶+ç²¾ä¿®

# YOLO11n head
head:
  #P5+P4ï¼Œä¸Šé‡‡æ ·
  - [-1, 1, nn.Upsample, [None, 2, "nearest"]] # ä¸Šé‡‡æ ·x2 å°†P5ç‰¹å¾å›¾å°ºå¯¸å˜ä¸º40x40ï¼Œé€šé“æ•°ä¸å˜ 40x40x1024
  - [[-1, 6], 1, Concat, [1]] # cat backbone P4  # èåˆP4ç‰¹å¾å›¾ 40x40x(1024+512) 40x40x1536 
  - [-1, 2, C3k2, [512, False]] # 13  CSPNet 40x40x512 å‹ç¼©é€šé“æ•°ï¼Œå¾—åˆ°P4åŠ å¼ºç‰¹å¾å›¾
  #P4+P3ï¼Œä¸Šé‡‡æ ·
  - [-1, 1, nn.Upsample, [None, 2, "nearest"]] # ä¸Šé‡‡æ ·x2 å°†P4ç‰¹å¾å›¾å°ºå¯¸å˜ä¸º80x80ï¼Œé€šé“æ•°ä¸å˜ 80x80x512
  - [[-1, 4], 1, Concat, [1]] # cat backbone P3 # èåˆP3ç‰¹å¾å›¾ 80x80x(512+256) 80x80x768
  - [-1, 2, C3k2, [256, False]] # 16 (P3/8-small) CSPNet 80x80x256 å‹ç¼©é€šé“æ•°ï¼Œå¾—åˆ°P3åŠ å¼ºç‰¹å¾å›¾ å°ç‰©ä½“æ£€æµ‹åˆ†æ”¯
 #P3+P4ï¼Œä¸‹é‡‡æ ·
  - [-1, 1, Conv, [256, 3, 2]]       # ä¸‹é‡‡æ ·x2 å°†P3ç‰¹å¾å›¾å°ºå¯¸å˜ä¸º40x40ï¼Œé€šé“æ•°å˜ä¸º256 40x40x256
  - [[-1, 13], 1, Concat, [1]] # cat head P4 # èåˆP4åŠ å¼ºç‰¹å¾å›¾ 40x40x(256+512) 40x40x768
  - [-1, 2, C3k2, [512, False]] # 19 (P4/16-medium) CSPNet 40x40x512 å‹ç¼©é€šé“æ•°ï¼Œå¾—åˆ°P4åŠ å¼ºç‰¹å¾å›¾ ä¸­ç‰©ä½“æ£€æµ‹åˆ†æ”¯
 #P4+P5ï¼Œä¸‹é‡‡æ ·
  - [-1, 1, Conv, [512, 3, 2]]      # ä¸‹é‡‡æ ·x2 å°†P4ç‰¹å¾å›¾å°ºå¯¸å˜ä¸º20x20ï¼Œé€šé“æ•°å˜ä¸º512 20x20x512
  - [[-1, 10], 1, Concat, [1]] # cat head P5 # èåˆP5åŠ å¼ºç‰¹å¾å›¾ 20x20x(512+1024) 20x20x1536
  - [-1, 2, C3k2, [1024, True]] # 22 (P5/32-large)  CSPNet 20x20x1024 å‹ç¼©é€šé“æ•°ï¼Œå¾—åˆ°P5åŠ å¼ºç‰¹å¾å›¾ å¤§ç‰©ä½“æ£€æµ‹åˆ†æ”¯

  - [[16, 19, 22], 1, Detect, [nc]] # Detect(P3, P4, P5) # æ£€æµ‹å¤´ è¾“å‡ºæ£€æµ‹ç»“æœ
